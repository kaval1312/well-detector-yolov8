# Приложение для обнаружения нефтяных скважин
**[➡веб-приложение⬅](https://well-detector-yolov8-ko3oxyhhgpthwubuhvjdmt.streamlit.app/)**

Нефть и газ остаются краеугольным камнем мировой энергетики, играя ключевую роль в экономическом развитии и благосостоянии населения. Как отмечается в Статистическом ежегоднике мировой энергетики BP за 2022 год, эффективное управление нефтегазовыми ресурсами приобретает все большую важность в контексте растущих экологических проблем и необходимости обеспечения энергетической безопасности.

Нефтяные скважины являются ключевым индикатором состояния нефтегазовых запасов. Их количество и распределение предоставляют ценную информацию о динамике добычи и потенциале месторождений. Удаленный мониторинг с использованием спутниковых снимков позволяет отслеживать глобальную эксплуатацию нефтяных ресурсов и оценивать уровень добычи в разных регионах.
## Цель проекта
Разработать и внедрить модель глубокого обучения для автоматического обнаружения нефтяных скважин на спутниковых снимках с высокой точностью и надежностью, особенно в условиях перекрытия объектов, сложного фона и различных углов обзора.
## Результаты первой версии
1) **Собран и предобработан датасет в Roboflow**
1) **Обученная модель YOLOv8:** модель обнаруживает скважины на спутниковых снимках с учетом различных факторов, влияющих на их внешний вид.  
2) **Веб-приложение Streamlit:** приложение предоставляет пользователям интерфейс для загрузки изображений, запуска процесса обнаружения и визуализацию результатов с bounding boxes и метками классов.
   
**С деталями можно ознакомиться в [ноутбуке](https://github.com/statsenko-na/well-detector-yolov8/blob/f50106dfca11e3d827dde0e1d937fcc507e9de06/other/Well_Detector.ipynb)**
# Использование
`Run streamlit run Home.py`  
Есть веб-версия [онлайн-демо](https://well-detector-yolov8-ko3oxyhhgpthwubuhvjdmt.streamlit.app/). Приложение откроется в окне браузера
## Используемые библиотеки
* ultralytics YOLOv8
* Roboflow
* Streamlit
## Датасет
Датасет с фото скважин со спутников берется из двух статей:  
 [Oil Well Detection under Occlusion in Remote Sensing Images Using the Improved YOLOv5 Model, 2023](https://www.mdpi.com/2072-4292/15/24/5788#)  
 [An Oil Well Dataset Derived from Satellite-Based Remote Sensing, 2021](https://www.mdpi.com/2072-4292/13/6/1132)  

> NEPU_OWOD-1.0 (Northeast Petroleum University - Oil Well Object Detection)  covers an area of 369 square kilometres and includes 1192 oil wells in 432 images (with a resolution of 0.41m per pixel).  The images are 768 * 768 pixels, 768 * 1024 pixels and 1024 * 1024 pixels.

> NEPU_OWOD-3.0 (Northeast Petroleum University - Oil Well Object Detection) California includes 1028 oil wells in 130 images (with a resolution of 0.48m per pixel).  The images are 512 * 512 pixels. 
**The format of the data set complies with the VOC2007 format.**

Датасет смешивается (562 изображения с аннотациями) и предобрабатывается в Roboflow.  

Preprocessing:
* Auto-Orient: Applied
* Resize: Stretch to 640x640
  
![Примеры из датасета](dataset_image.png "Примеры из датасета")
## Анализ ошибок
* Трудности с обнаружением перекрывающихся объектов: модель испытывает сложности с точной идентификацией и локализацией скважин, которые перекрываются друг с другом или другими объектами на изображении.
* Ложные срабатывания: в некоторых случаях модель может ошибочно идентифицировать другие объекты, например, нефтяные резервуары или схожие по форме сооружения, как скважины.
* Пропущенные обнаружения: модель может пропускать скважины с низким контрастом, маленькие скважины или скважины, расположенные в сложных условиях освещения или фона.
## Пути решения
* Использования контекстной информации: анализ окружающих объектов
* OBB-обнаружение
* Комбинирование обнаружения и сегментации: позволит сначала локализовать скважины, а затем получить точные границы и отделить перекрывающиеся объекты.
* Использование более крупных моделей
* Обучение на данных с разными масштабами
* Расширение и диверсификация датасета: разнообразить датасет фонами, углами обзора, типами скважин и степенями перекрытия.
## Идеальный прототип
Идеальный прототип приложения представляет собой веб-сервис, который регулярно, с определенной периодичностью и на основе заданных эвристик, выполняет поиск по спутниковым снимкам. Он отображает на карте координаты скважин и примерную дату их появления. 
Кроме того, приложение предоставляет дополнительную ГИС-информацию, включая:
* Название месторождения
* Информация о месторождении, на котором обнаружены скважины.
* Тип ресурса (нефть, газ или конденсат)
* Статус скважины (активная, заброшенная)
* Экологические данные
